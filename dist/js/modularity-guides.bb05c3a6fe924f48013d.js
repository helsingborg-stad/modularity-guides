!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";function o(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}n.r(t);(function(e){var t={info:"c-notice--info",success:"c-notice--success",danger:"c-notice--danger",warning:"c-notice--warning"};function n(e){var n;e.preventDefault();var r=e.target,i=r.closest(".js-modularity-guide-todos"),a=null==r||null===(n=r.querySelector('input[name="email"]'))||void 0===n?void 0:n.value;function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=i.querySelector(".js-modularity-guide-todos__notice"),l=a.querySelectorAll("c-icon"),u=a.classList,c=t[n];if(!1!==e){if(c&&!u.contains(c)&&(o(u).filter((function(e){return Object.values(t).includes(e)})).forEach((function(e){u.remove(e)})),u.add(c)),e.length>0){var d=a.querySelectorAll("span"),s=2===d.length?d[1]:d[0];s.innerHTML=e,r.length>0&&l&&(l.innerHTML=r),u.remove("u-display--none")}}else u.contains("u-display--none")||u.add("u-display--none")}l(!1);var u=null==i?void 0:i.querySelector(".js-modularity-guide-todos__table");if(u&&a&&ajaxurl){i.classList.toggle("is-loading");var c={action:"email_todo",checklist:function(e){var t,n,o=e.cloneNode(!0);null===(t=o=document.body.appendChild(o))||void 0===t||null===(n=t.querySelectorAll("tr"))||void 0===n||n.forEach((function(e){var t;(t=e).offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0||e.remove()}));var r=o.outerHTML;return o.remove(),encodeURI(r)}(u),email:a};fetch(ajaxurl,{method:"POST",credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:new URLSearchParams(c)}).then((function(e){i.classList.toggle("is-loading"),e.json().then((function(e){e?(i.classList.toggle("is-loading"),l(guides.email_sent,"success","report"),setTimeout((function(){l(!1),i.querySelector(".js-modularity-guide-todos__modal .c-modal__close").click()}),2e3)):l(guides.email_failed,"danger","report")}))})).catch((function(e){console.log(JSON.stringify(e))}))}}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide-todos");(null==e?void 0:e.length)>0&&e.forEach((function(e,t){!function(e,t){var o;null==e||null===(o=e.querySelector(".js-modularity-guide-todos__form"))||void 0===o||o.addEventListener("submit",n)}(e)}))}))})(jQuery),function(e){function t(){this.handleEvents(),this.contentToggleEngine()}t.prototype.handleEvents=function(){e('input[type="checkbox"][data-mod-guide-relation]').on("change",(function(t){var n=e(this).data("mod-guide-relation");n=n.split(","),e.each(n,(function(t,n){var o=e('input[type="checkbox"][data-mod-guide-toggle-key="'+n+'"]');o.prop("checked",!o.prop("checked")).trigger("change")}))})),e("[data-mod-guide-toggle-key]").on("change",function(e){this.contentToggleEngine()}.bind(this))},t.prototype.contentToggleEngine=function(){var t=[];e("[data-mod-guide-toggle-key]").each((function(n,o){!0===e(o).prop("checked")&&t.push(e(o).attr("data-mod-guide-toggle-key"))})),e("[data-mod-guide-toggle-key-content]").each((function(n,o){var r=!1,i=e(o).attr("data-mod-guide-toggle-key-content");i=i.split(","),e.each(i,(function(e,n){var o=n.match(/(^|\+)([^\+\-]+)/g),i=new RegExp("\\b("+o.join("|").replace("+","")+")\\b","ig"),a=t.join(",").match(i),l=null!==a&&a.length===o.length,u=n.match(/\-([^\+\-]+)/g),c=!0;if(null!==u){var d=new RegExp("\\b("+u.join("|").replace("-","")+")\\b","ig"),s=t.join(",").match(d);c=!(null!==s&&s.length>0)}l&&c&&(r=!0)})),!0!==r?e(o).hide():e(o).show()}))},new t}(jQuery);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function l(e){var t;e.preventDefault(),console.log("next prev");var n=e.target,o=e.target.classList.contains(".js-modularity-guide__next".substring(1)),r=null==n?void 0:n.closest(".js-modularity-guide"),i=null==n?void 0:n.closest(".js-modularity-guide__section"),a=parseInt(null!==(t=null==i?void 0:i.getAttribute("data-guide-step"))&&void 0!==t?t:"-1");if(a>0){var l=o?a+1:a-1,u=null==r?void 0:r.querySelector("[".concat("data-guide-step",'="').concat(l,'"]')),c=null==u?void 0:u.querySelector("[js-expand-button]");c&&c.click()}}function u(e){var t=[].concat(i(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__next"))),i(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__prev"))));t.length>0&&t.forEach((function(e){e.addEventListener("click",l)}))}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide");e&&e.length>0&&e.forEach(u)}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL0NvbnRlbnQvVG9kby5qcyIsIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvQ29udGVudC9jaGVja2JveGVzLmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9qcy9tb2R1bGFyaXR5LWd1aWRlcy5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIiQiLCJOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FUyIsImluZm8iLCJzdWNjZXNzIiwiZGFuZ2VyIiwid2FybmluZyIsImhhbmRsZVN1Ym1pdCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImN1cnJlbnRGb3JtIiwidGFyZ2V0IiwiY3VycmVudFNlY3Rpb24iLCJjbG9zZXN0IiwiZW1haWwiLCJxdWVyeVNlbGVjdG9yIiwic2V0Tm90aWNlIiwidGV4dCIsImxldmVsIiwiaWNvbiIsIm5vdGljZUVsZW1lbnQiLCJub3RpY2VJY29uRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJub3RpY2VDbGFzc0xpc3QiLCJjbGFzc0xpc3QiLCJub3RpY2VMZXZlbENsYXNzTmFtZSIsImNvbnRhaW5zIiwiZmlsdGVyIiwiY2xhc3NOYW1lIiwidmFsdWVzIiwiaW5jbHVkZXMiLCJmb3JFYWNoIiwicmVtb3ZlIiwiYWRkIiwibGVuZ3RoIiwic3BhbkVsZW1lbnRzIiwidGV4dFNwYW4iLCJpbm5lckhUTUwiLCJ0b2RvVGFibGUiLCJhamF4dXJsIiwidG9nZ2xlIiwiZGF0YSIsImFjdGlvbiIsImNoZWNrbGlzdCIsImNsb25lTm9kZSIsImRvY3VtZW50IiwiYm9keSIsImFwcGVuZENoaWxkIiwicm93IiwiZWxlbSIsIm9mZnNldFdpZHRoIiwib2Zmc2V0SGVpZ2h0IiwiZ2V0Q2xpZW50UmVjdHMiLCJjaGVja2xpc3RIVE1MIiwib3V0ZXJIVE1MIiwiZW5jb2RlVVJJIiwiZ2V0Q2hlY2tMaXN0IiwiZmV0Y2giLCJtZXRob2QiLCJjcmVkZW50aWFscyIsImhlYWRlcnMiLCJIZWFkZXJzIiwiVVJMU2VhcmNoUGFyYW1zIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsImd1aWRlcyIsImVtYWlsX3NlbnQiLCJzZXRUaW1lb3V0IiwiY2xpY2siLCJlbWFpbF9mYWlsZWQiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwidG9kb1NlY3Rpb25zIiwidG9kb1NlY3Rpb24iLCJpbmRleCIsInN1YnNjcmliZUZvcm0iLCJqUXVlcnkiLCJDaGVja2JveGVzIiwidGhpcyIsImhhbmRsZUV2ZW50cyIsImNvbnRlbnRUb2dnbGVFbmdpbmUiLCJvbiIsInJlbGF0aW9ucyIsInNwbGl0IiwiZWFjaCIsIml0ZW0iLCIkY2IiLCJwcm9wIiwidHJpZ2dlciIsImNoZWNrZWQiLCJlbGVtZW50IiwicHVzaCIsImF0dHIiLCJzaG91bGRTaG93IiwiY29uZGl0aW9ucyIsImFuZCIsIm1hdGNoIiwiYW5kUGF0dGVybiIsIlJlZ0V4cCIsImpvaW4iLCJyZXBsYWNlIiwiYW5kTWF0Y2hlcyIsImFuZElzTWF0Y2hpbmciLCJhbmRub3QiLCJhbmRub3RJc01hdGNoaW5nIiwiYW5kbm90UGF0dGVybiIsImFuZG5vdE1hdGNoZXMiLCJoaWRlIiwic2hvdyIsImhhbmRsZVByZXZOZXh0Q2xpY2siLCJwcmV2TmV4dEJ1dHRvbkVsZW1lbnQiLCJpc05leHQiLCJzdWJzdHJpbmciLCJjdXJyZW50R3VpZGUiLCJjdXJyZW50U3RlcCIsInBhcnNlSW50IiwiZ2V0QXR0cmlidXRlIiwidGFyZ2V0U3RlcCIsInRhcmdldFNlY3Rpb24iLCJ0YXJnZXRUb2dnbGUiLCJzdWJzY3JpYmVQcmV2TmV4dEJ1dHRvbnMiLCJ3cmFwcGVyRWxlbWVudCIsImJ1dHRvbnMiLCJidXR0b25FbGVtZW50IiwiZ3VpZGVNb2R1bGVzIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMvQixFQUFQRSxFQUFVLE9BQU9GLEVBQ3BC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Q2pFSCxTQUFTaUMsRUFBb0I1RyxHQUFHLE1BQzVCQSxFQUFFQyxpQkFFRmdFLFFBQVFDLElBQUksYUFFWixJQUFNMkMsRUFBd0I3RyxFQUFFRyxPQUMxQjJHLEVBQVM5RyxFQUFFRyxPQUFPYSxVQUFVRSxTQWxCaEIsNkJBa0J1QzZGLFVBQVUsSUFHN0RDLEVBQWVILGFBQUgsRUFBR0EsRUFBdUJ4RyxRQXZCZCx3QkF3QnhCRCxFQUFpQnlHLGFBQUgsRUFBR0EsRUFBdUJ4RyxRQXZCekIsaUNBd0JmNEcsRUFBY0MsU0FBUSxVQUFDOUcsYUFBRCxFQUFDQSxFQUFnQitHLGFBbEIxQiwwQkFrQlMsUUFBaUQsTUFFN0UsR0FBSUYsRUFBYyxFQUFHLENBQ2pCLElBQU1HLEVBQWFOLEVBQVNHLEVBQWMsRUFBSUEsRUFBYyxFQUN0REksRUFBZ0JMLGFBQUgsRUFBR0EsRUFBY3pHLGNBQWQsV0F0QlAsa0JBc0JPLGFBQW1ENkcsRUFBbkQsT0FDaEJFLEVBQWVELGFBQUgsRUFBR0EsRUFBZTlHLGNBMUJWLHNCQTRCdEIrRyxHQUNBQSxFQUFhekQsU0FTekIsU0FBUzBELEVBQXlCQyxHQUM5QixJQUFNQyxFQUFVLEdBQUgsU0FDTkQsRUFBZTFHLGlCQUFmLFVBM0NjLGdDQTJDZCxZQTFDVyxnQ0F5Q0wsRUFFTjBHLEVBQWUxRyxpQkFBZixVQTVDYyxnQ0E0Q2QsWUExQ1csaUNBNkNkMkcsRUFBUS9GLE9BQVMsR0FDakIrRixFQUFRbEcsU0FBUSxTQUFBbUcsR0FDWkEsRUFBY3BELGlCQUFpQixRQUFTc0MsTUFnQnBEdkMsT0FBT0MsaUJBQWlCLG9CQVJ4QixXQUNJLElBQU1xRCxFQUFldEYsU0FBU3ZCLGlCQTNEQSx3QkE2RDFCNkcsR0FBZ0JBLEVBQWFqRyxPQUFTLEdBQ3RDaUcsRUFBYXBHLFFBQVFnRyIsImZpbGUiOiJqcy9tb2R1bGFyaXR5LWd1aWRlcy5iYjA1YzNhNmZlOTI0ZjQ4MDEzZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAxKTtcbiIsImV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiAoJCkge1xuICAgIGNvbnN0IFNFTEVDVE9SX1RPRE9TX1dSQVBQRVIgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUtdG9kb3MnO1xuICAgIGNvbnN0IFNFTEVDVE9SX0ZPUk0gPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUtdG9kb3NfX2Zvcm0nO1xuICAgIGNvbnN0IFNFTEVDVE9SX01PREFMX0NMT1NFX0JVVFRPTiA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvc19fbW9kYWwgLmMtbW9kYWxfX2Nsb3NlJztcbiAgICBjb25zdCBTRUxFQ1RPUl9NT0RBTF9UUklHR0VSX0JVVFRPTiA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvc19fbW9kYWwtdHJpZ2dlcic7XG4gICAgY29uc3QgU0VMRUNUT1JfRk9STV9OT1RJQ0UgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUtdG9kb3NfX25vdGljZSc7XG4gICAgY29uc3QgU0VMRUNUT1JfVEFCTEUgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUtdG9kb3NfX3RhYmxlJztcblxuICAgIGNvbnN0IFNFTEVDVE9SX0lOUFVUX0VNQUlMID0gJ2lucHV0W25hbWU9XCJlbWFpbFwiXSc7XG5cbiAgICBjb25zdCBOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FUyA9IHtcbiAgICAgICAgaW5mbzogJ2Mtbm90aWNlLS1pbmZvJyxcbiAgICAgICAgc3VjY2VzczogJ2Mtbm90aWNlLS1zdWNjZXNzJyxcbiAgICAgICAgZGFuZ2VyOiAnYy1ub3RpY2UtLWRhbmdlcicsXG4gICAgICAgIHdhcm5pbmc6ICdjLW5vdGljZS0td2FybmluZydcbiAgICB9O1xuXG5cbiAgICAvKipcbiAgICAgKiBVdGlsaXR5IHRvIGNoZWNrIGlmIGVsZW1lbnQgaXMgdmlzaWJsZSBvciBub3RcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1cbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn1cbiAgICAgKi9cbiAgICBjb25zdCBpc1Zpc2libGUgPSAoZWxlbSkgPT4gKGVsZW0ub2Zmc2V0V2lkdGggPiAwIHx8IGVsZW0ub2Zmc2V0SGVpZ2h0ID4gMCB8fCBlbGVtLmdldENsaWVudFJlY3RzKCkubGVuZ3RoID4gMCk7XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGNoZWNrbGlzdCBodG1sIGZyb20gdG9kbyB0YWJsZVxuICAgICAqIEBwYXJhbSB7RWxlbWVudH0gdG9kb1RhYmxlXG4gICAgICogQHJldHVybnMge1N0cmluZ30gaHRtbCB3aXRoIHZpc2libGUgY2hlY2tsaXN0IGl0ZW1zXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0Q2hlY2tMaXN0KHRvZG9UYWJsZSkge1xuICAgICAgICBsZXQgY2hlY2tsaXN0ID0gdG9kb1RhYmxlLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgY2hlY2tsaXN0ID0gZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjaGVja2xpc3QpO1xuXG4gICAgICAgIC8vIFJlbW92ZSBub3QgdmlzaWJsZSByb3dzXG4gICAgICAgIGNoZWNrbGlzdD8ucXVlcnlTZWxlY3RvckFsbCgndHInKT8uZm9yRWFjaChyb3cgPT4ge1xuICAgICAgICAgICAgaWYgKGlzVmlzaWJsZShyb3cpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcm93LnJlbW92ZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgY2hlY2tsaXN0SFRNTCA9IGNoZWNrbGlzdC5vdXRlckhUTUw7XG4gICAgICAgIGNoZWNrbGlzdC5yZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIGVuY29kZVVSSShjaGVja2xpc3RIVE1MKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZW5kIGNoZWNrbGlzdCBlbWFpbCB0aHJvdWdoIHdvcmRwcmVzcyBvbiBzdWJtaXRcbiAgICAgKiBAcGFyYW0ge1N1Ym1pdEV2ZW50fSBlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGFuZGxlU3VibWl0KGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRGb3JtID0gZS50YXJnZXQ7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRTZWN0aW9uID0gY3VycmVudEZvcm0uY2xvc2VzdChTRUxFQ1RPUl9UT0RPU19XUkFQUEVSKTtcbiAgICAgICAgY29uc3QgZW1haWwgPSBjdXJyZW50Rm9ybT8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9JTlBVVF9FTUFJTCk/LnZhbHVlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwbGF5IG9yIGhpZGUgZm9ybSBub3RpY2VcbiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd8Qm9vbGVhbn0gdGV4dCBub3RpY2UgY29udGVudCwgc2V0IHRvIGZhbHNlIHRvIGhpZGUgbm90aWNlXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBsZXZlbCAgbm90aWNlIGxldmVsIC0gaW5mbywgZGFuZ2VyLCB3YXJuaW5nLCBzdWNjZXNzXG4gICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpY29uIG1hdGVyaWFsIGljb24gbmFtZVxuICAgICAgICAgKiBAcmV0dXJuc1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0Tm90aWNlKHRleHQsIGxldmVsID0gJ2luZm8nLCBpY29uID0gJycpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUVsZW1lbnQgPSBjdXJyZW50U2VjdGlvbi5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0ZPUk1fTk9USUNFKTtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUljb25FbGVtZW50ID0gbm90aWNlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdjLWljb24nKTtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUNsYXNzTGlzdCA9IG5vdGljZUVsZW1lbnQuY2xhc3NMaXN0O1xuICAgICAgICAgICAgY29uc3Qgbm90aWNlTGV2ZWxDbGFzc05hbWUgPSBOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FU1tsZXZlbF07XG5cbiAgICAgICAgICAgIGlmICh0ZXh0ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGlmICghbm90aWNlQ2xhc3NMaXN0LmNvbnRhaW5zKCd1LWRpc3BsYXktLW5vbmUnKSkge1xuICAgICAgICAgICAgICAgICAgICBub3RpY2VDbGFzc0xpc3QuYWRkKCd1LWRpc3BsYXktLW5vbmUnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChub3RpY2VMZXZlbENsYXNzTmFtZSAmJiAhbm90aWNlQ2xhc3NMaXN0LmNvbnRhaW5zKG5vdGljZUxldmVsQ2xhc3NOYW1lKSkge1xuXG4gICAgICAgICAgICAgICAgWy4uLm5vdGljZUNsYXNzTGlzdF1cbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihjbGFzc05hbWUgPT4gKFxuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FUykuaW5jbHVkZXMoY2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgICAgICAgICAuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWNlQ2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIG5vdGljZUNsYXNzTGlzdC5hZGQobm90aWNlTGV2ZWxDbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BhbkVsZW1lbnRzID0gbm90aWNlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzcGFuJyk7XG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dFNwYW4gPSBzcGFuRWxlbWVudHMubGVuZ3RoID09PSAyID8gc3BhbkVsZW1lbnRzWzFdIDogc3BhbkVsZW1lbnRzWzBdO1xuICAgICAgICAgICAgICAgIHRleHRTcGFuLmlubmVySFRNTCA9IHRleHQ7XG5cblxuICAgICAgICAgICAgICAgIGlmIChpY29uLmxlbmd0aCA+IDAgJiYgbm90aWNlSWNvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWNlSWNvbkVsZW1lbnQuaW5uZXJIVE1MID0gaWNvbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBub3RpY2VDbGFzc0xpc3QucmVtb3ZlKCd1LWRpc3BsYXktLW5vbmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHNldE5vdGljZShmYWxzZSk7XG5cbiAgICAgICAgY29uc3QgdG9kb1RhYmxlID0gY3VycmVudFNlY3Rpb24/LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfVEFCTEUpO1xuXG4gICAgICAgIGlmICh0b2RvVGFibGUgJiYgZW1haWwgJiYgYWpheHVybCkge1xuICAgICAgICAgICAgY3VycmVudFNlY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtbG9hZGluZycpO1xuXG4gICAgICAgICAgICBjb25zdCBjaGVja2xpc3QgPSBnZXRDaGVja0xpc3QodG9kb1RhYmxlKTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnZW1haWxfdG9kbycsXG4gICAgICAgICAgICAgICAgY2hlY2tsaXN0OiBjaGVja2xpc3QsXG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZmV0Y2goYWpheHVybCwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAnc2FtZS1vcmlnaW4nLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHsnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCd9KSxcbiAgICAgICAgICAgICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKGRhdGEpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50U2VjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1sb2FkaW5nJyk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmpzb24oKS50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWxvYWRpbmcnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldE5vdGljZShndWlkZXMuZW1haWxfc2VudCwgJ3N1Y2Nlc3MnLCAncmVwb3J0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldE5vdGljZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsb3NlTW9kYWwgPSBjdXJyZW50U2VjdGlvbi5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX01PREFMX0NMT1NFX0JVVFRPTik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlTW9kYWwuY2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXROb3RpY2UoZ3VpZGVzLmVtYWlsX2ZhaWxlZCwgJ2RhbmdlcicsICdyZXBvcnQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoZXJyb3IpKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IHRvZG9TZWN0aW9uXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4XG4gICAgICovXG4gICAgZnVuY3Rpb24gc3Vic2NyaWJlRm9ybSh0b2RvU2VjdGlvbiwgaW5kZXgpIHtcbiAgICAgICAgdG9kb1NlY3Rpb24/LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfRk9STSk/LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZVN1Ym1pdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUXVlcnkgVG9EbyBzZWN0aW9ucyAmIGluaXRpYWxpemUgZ3JlYXQgdGhpbmdzXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgY29uc3QgdG9kb1NlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChTRUxFQ1RPUl9UT0RPU19XUkFQUEVSKTtcbiAgICAgICAgaWYgKHRvZG9TZWN0aW9ucz8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdG9kb1NlY3Rpb25zLmZvckVhY2goKHRvZG9TZWN0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZUZvcm0odG9kb1NlY3Rpb24sIGluZGV4KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0KTtcbn0pKGpRdWVyeSk7XG4iLCJleHBvcnQgZGVmYXVsdCAoZnVuY3Rpb24gKCQpIHtcblxuICAgIGZ1bmN0aW9uIENoZWNrYm94ZXMoKSB7XG4gICAgICAgIHRoaXMuaGFuZGxlRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuY29udGVudFRvZ2dsZUVuZ2luZSgpO1xuICAgIH1cblxuICAgIENoZWNrYm94ZXMucHJvdG90eXBlLmhhbmRsZUV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXVtkYXRhLW1vZC1ndWlkZS1yZWxhdGlvbl0nKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICAgICAgbGV0IHJlbGF0aW9ucyA9ICQodGhpcykuZGF0YSgnbW9kLWd1aWRlLXJlbGF0aW9uJyk7XG4gICAgICAgICAgICByZWxhdGlvbnMgPSByZWxhdGlvbnMuc3BsaXQoJywnKTtcblxuICAgICAgICAgICAgJC5lYWNoKHJlbGF0aW9ucywgZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG4gICAgICAgICAgICAgICAgbGV0ICRjYiA9ICQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXVtkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5PVwiJyArIGl0ZW0gKyAnXCJdJyk7XG4gICAgICAgICAgICAgICAgJGNiLnByb3AoJ2NoZWNrZWQnLCAhJGNiLnByb3AoJ2NoZWNrZWQnKSkudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnW2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXldJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUb2dnbGVFbmdpbmUoKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuXG4gICAgfTtcblxuICAgIENoZWNrYm94ZXMucHJvdG90eXBlLmNvbnRlbnRUb2dnbGVFbmdpbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gR2V0IGNoZWNrZWQgY2hlY2tib3hlc1xuICAgICAgICBsZXQgY2hlY2tlZCA9IFtdO1xuICAgICAgICBsZXQgJGNoZWNrYm94ZXMgPSAkKCdbZGF0YS1tb2QtZ3VpZGUtdG9nZ2xlLWtleV0nKTtcblxuICAgICAgICAkY2hlY2tib3hlcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKCQoZWxlbWVudCkucHJvcCgnY2hlY2tlZCcpICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjaGVja2VkLnB1c2goJChlbGVtZW50KS5hdHRyKCdkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5JykpO1xuXG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRGlzcGxheSBvciBoaWRlIGNvbnRlbnRcbiAgICAgICAgJCgnW2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXktY29udGVudF0nKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xuICAgICAgICAgICAgbGV0IHNob3VsZFNob3cgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBjb25kaXRpb25zID0gJChlbGVtZW50KS5hdHRyKCdkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5LWNvbnRlbnQnKTtcbiAgICAgICAgICAgIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLnNwbGl0KCcsJyk7XG5cbiAgICAgICAgICAgIC8vIERhdGVybWluZCBpZiBjb250ZW50IHNob3VsZCBiZSBzaG93biBvciBub3RcbiAgICAgICAgICAgICQuZWFjaChjb25kaXRpb25zLCBmdW5jdGlvbiAoaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBsZXQgYW5kID0gaXRlbS5tYXRjaCgvKF58XFwrKShbXlxcK1xcLV0rKS9nKTtcbiAgICAgICAgICAgICAgICBsZXQgYW5kUGF0dGVybiA9IG5ldyBSZWdFeHAoJ1xcXFxiKCcgKyBhbmQuam9pbignfCcpLnJlcGxhY2UoJysnLCAnJykgKyAnKVxcXFxiJywgJ2lnJyk7XG4gICAgICAgICAgICAgICAgbGV0IGFuZE1hdGNoZXMgPSBjaGVja2VkLmpvaW4oJywnKS5tYXRjaChhbmRQYXR0ZXJuKTtcbiAgICAgICAgICAgICAgICBsZXQgYW5kSXNNYXRjaGluZyA9IGFuZE1hdGNoZXMgIT09IG51bGwgJiYgYW5kTWF0Y2hlcy5sZW5ndGggPT09IGFuZC5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBsZXQgYW5kbm90ID0gaXRlbS5tYXRjaCgvXFwtKFteXFwrXFwtXSspL2cpO1xuICAgICAgICAgICAgICAgIGxldCBhbmRub3RJc01hdGNoaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoYW5kbm90ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhbmRub3RQYXR0ZXJuID0gbmV3IFJlZ0V4cCgnXFxcXGIoJyArIGFuZG5vdC5qb2luKCd8JykucmVwbGFjZSgnLScsICcnKSArICcpXFxcXGInLCAnaWcnKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFuZG5vdE1hdGNoZXMgPSBjaGVja2VkLmpvaW4oJywnKS5tYXRjaChhbmRub3RQYXR0ZXJuKTtcbiAgICAgICAgICAgICAgICAgICAgYW5kbm90SXNNYXRjaGluZyA9ICEoYW5kbm90TWF0Y2hlcyAhPT0gbnVsbCAmJiBhbmRub3RNYXRjaGVzLmxlbmd0aCA+IDApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChhbmRJc01hdGNoaW5nICYmIGFuZG5vdElzTWF0Y2hpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkU2hvdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEhpZGUgb3Igc2hvd1xuICAgICAgICAgICAgaWYgKHNob3VsZFNob3cgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnNob3coKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQoZWxlbWVudCkuaGlkZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuXG5cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgQ2hlY2tib3hlcygpO1xuXG59KShqUXVlcnkpO1xuIiwiaW1wb3J0ICcuL0NvbnRlbnQvVG9kby5qcyc7XG5pbXBvcnQgJy4vQ29udGVudC9jaGVja2JveGVzLmpzJztcblxuLy8gUmVxdWlyZWQgc2VsZWN0b3JzXG5jb25zdCBTRUxFQ1RPUl9NT0RVTEFSSVRZX0dVSURFID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlJztcbmNvbnN0IFNFTEVDVE9SX1NFQ1RJT04gPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGVfX3NlY3Rpb24nO1xuY29uc3QgU0VMRUNUT1JfTkVYVCA9ICcuanMtbW9kdWxhcml0eS1ndWlkZV9fbmV4dCc7XG5jb25zdCBTRUxFQ1RPUl9QUkVWID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlX19wcmV2JztcbmNvbnN0IFNFTEVDVE9SX0FDQ09SRElPTl9UT0dHTEUgPSAnW2pzLWV4cGFuZC1idXR0b25dJztcblxuLy8gUmVxdWlyZWQgZGF0YS1hdHRyaWJ1dGVzXG5jb25zdCBBVFRSSUJVVEVfU1RFUCA9ICdkYXRhLWd1aWRlLXN0ZXAnO1xuXG4vKipcbiAqIENsaWNrIGhhbmRsZXIgZm9yIE5leHQgJiBQcmV2IGJ1dHRvbnMsXG4gKiB3aWxsIHRyYXZlcnNlIHVwIHRvIGZpbmQgY3VycmVudCwgcHJldmlvdXMgYW5kIHRoZSBuZXh0IHN0ZXAgdG8gc2ltdWxhdGUgYWNjb3JkaW9uIGNsaWNrXG4gKiBAcGFyYW0geyp9IGUgZXZlbnRcbiAqL1xuZnVuY3Rpb24gaGFuZGxlUHJldk5leHRDbGljayhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc29sZS5sb2coXCJuZXh0IHByZXZcIik7IFxuXG4gICAgY29uc3QgcHJldk5leHRCdXR0b25FbGVtZW50ID0gZS50YXJnZXQ7XG4gICAgY29uc3QgaXNOZXh0ID0gZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFNFTEVDVE9SX05FWFQuc3Vic3RyaW5nKDEpKTtcblxuICAgIC8vIFRyYXZlcnNlIERPTSB1cHdhcmRzXG4gICAgY29uc3QgY3VycmVudEd1aWRlID0gcHJldk5leHRCdXR0b25FbGVtZW50Py5jbG9zZXN0KFNFTEVDVE9SX01PRFVMQVJJVFlfR1VJREUpO1xuICAgIGNvbnN0IGN1cnJlbnRTZWN0aW9uID0gcHJldk5leHRCdXR0b25FbGVtZW50Py5jbG9zZXN0KFNFTEVDVE9SX1NFQ1RJT04pO1xuICAgIGNvbnN0IGN1cnJlbnRTdGVwID0gcGFyc2VJbnQoY3VycmVudFNlY3Rpb24/LmdldEF0dHJpYnV0ZShBVFRSSUJVVEVfU1RFUCkgPz8gJy0xJyk7XG5cbiAgICBpZiAoY3VycmVudFN0ZXAgPiAwKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFN0ZXAgPSBpc05leHQgPyBjdXJyZW50U3RlcCArIDEgOiBjdXJyZW50U3RlcCAtIDE7XG4gICAgICAgIGNvbnN0IHRhcmdldFNlY3Rpb24gPSBjdXJyZW50R3VpZGU/LnF1ZXJ5U2VsZWN0b3IoYFske0FUVFJJQlVURV9TVEVQfT1cIiR7dGFyZ2V0U3RlcH1cIl1gKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0VG9nZ2xlID0gdGFyZ2V0U2VjdGlvbj8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9BQ0NPUkRJT05fVE9HR0xFKTtcblxuICAgICAgICBpZiAodGFyZ2V0VG9nZ2xlKSB7XG4gICAgICAgICAgICB0YXJnZXRUb2dnbGUuY2xpY2soKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbi8qKlxuICogU3Vic2NyaWJlIHByZXYvbmV4dCBidXR0b24gY2xpY2sgZXZlbnRcbiAqIEBwYXJhbSB7RWxlbWVudH0gd3JhcHBlckVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gc3Vic2NyaWJlUHJldk5leHRCdXR0b25zKHdyYXBwZXJFbGVtZW50KSB7XG4gICAgY29uc3QgYnV0dG9ucyA9IFtcbiAgICAgICAgLi4ud3JhcHBlckVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChgJHtTRUxFQ1RPUl9TRUNUSU9OfSAke1NFTEVDVE9SX05FWFR9YCksXG4gICAgICAgIC4uLndyYXBwZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCR7U0VMRUNUT1JfU0VDVElPTn0gJHtTRUxFQ1RPUl9QUkVWfWApLFxuICAgIF07XG5cbiAgICBpZiAoYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b25FbGVtZW50ID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVQcmV2TmV4dENsaWNrKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFF1ZXJ5IGd1aWRlIG1vZHVsZXMgJiBpbml0aWFsaXplIHN0dWZmXG4gKi9cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgY29uc3QgZ3VpZGVNb2R1bGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChTRUxFQ1RPUl9NT0RVTEFSSVRZX0dVSURFKTtcblxuICAgIGlmIChndWlkZU1vZHVsZXMgJiYgZ3VpZGVNb2R1bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZ3VpZGVNb2R1bGVzLmZvckVhY2goc3Vic2NyaWJlUHJldk5leHRCdXR0b25zKTtcbiAgICB9XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCk7Il0sInNvdXJjZVJvb3QiOiIifQ==